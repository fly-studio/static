{"version":3,"sources":["jquery.uploader.js"],"names":["$","UPLOADER_LANGUAGE","close","drop_container","drop_tips","drop_button","select_file","ctrl_v_tips","ctrl_v_button","resize","uploading","success","rotate_right","rotate_left","loading","reading","filetype","filenum_limite","hashing","hash_success","error","num_limit","allsize_limit","filesize_limite","duplicate","baseuri","fn","extend","uploader","max_width","max_height","filesize","filelimit","id","options","parseFloat","toLowerCase","parseInt","img_types","this","each","t","flex_uploader","prop","$container","remove","removeProp","method","interval","nonce","rand","uploader_id","pick_id","progresses_id","thumbnails_id","bytesToSize","replace","toString","toHTML","insertAfter","tooltip","$progresses","progress","file","name","size","appendTo","on","getStatus","cancel","init","removeClass","initProgress","thumb","makeThumb","ret","attr","ext","html","message","setStatus","addClass","progressing","percentage","is_hashing","toFixed","$bar","width","text","delay","queue","alert","dequeue","cancelFile","$thumbnails","preview","filename","fileext","encodeURIComponent","rotation","data","is","deg","css","supportTransition","-webkit-transform","-mos-transform","-o-transform","transform","filter","pic","indexOf","GET","json","result","displayname","build","triggerHandler","getFile","attachment","get","add","removeFile","setFile","removeAll","rebuildAll","files","getFiles","i","length","aids","aid","val","Array","split","write","empty","forEach","append","push","splice","beforeFileQueued","fileQueued","upload","md5File","then","POST","hash","_token","csrf","md5","skipFile","uploadBeforeSend","obj","headers","uuid","blob","ruid","start","end","chunks","chunk","total","uploadStart","uploadProgress","uploadSuccess","content","uploadError","reason","uploadComplete","code","max","create","WebUploader","swf","server","pick","document","getElementById","multiple","formData","session_id","PHPSESSIONID","fileVal","sendAsBinary","fileNumLimit","fileSingleSizeLimit","accept","title","extensions","mimeTypes","mimeType","map","v","lookup","join","prepareNextFile","chunkSize","chunkRetry","chunked","threads","dnd","disableGlobalDnd","height","quality","allowMagnify","crop","compress","option","preserveHeaders","noCompressIfLarger","compressSize","setInterval","clearInterval","jQuery"],"mappings":"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","file":"jquery.uploader.min.js","sourcesContent":["(function($){\r\n\t$.UPLOADER_LANGUAGE = {\r\n\t\t'close' : '\\u5173\\u95ed',\r\n\t\t'drop_container' : '\\u62d6\\u5230\\u6587\\u4ef6\\u5230\\u8fd9\\u91cc',\r\n\t\t'drop_tips' : '\\u652f\\u6301\\u4eceWindows\\u4e2d\\u62d6\\u52a8\\u6587\\u4ef6\\u5230\\u8fd9\\u91cc\\u4e0a\\u4f20\\uff08\\u9700\\u73b0\\u4ee3\\u6d4f\\u89c8\\u5668\\uff09',\r\n\t\t'drop_button' : '\\u62d6\\u653e\\u6587\\u4ef6',\r\n\t\t'select_file' : '\\u9009\\u62e9\\u6587\\u4ef6',\r\n\t\t'ctrl_v_tips' : '\\u53ef\\u4ee5\\u4f7f\\u7528Ctrl+V\\u76f4\\u63a5\\u7c98\\u8d34\\u622a\\u56fe\\uff08\\u9700\\u73b0\\u4ee3\\u6d4f\\u89c8\\u5668\\uff09',\r\n\t\t'ctrl_v_button' : 'Ctrl+V \\u622a\\u56fe',\r\n\t\t'resize' : '\\u56fe\\u7247\\u4f1a\\u81ea\\u52a8\\u7b49\\u6bd4\\u7f29\\u653e\\u81f3\\uff1a{0} (\\u4ec5jpg)',\r\n\t\t'uploading' : '\\u6b63\\u5728\\u4e0a\\u4f20\\u6587\\u4ef6...',\r\n\t\t'success' : '\\u4e0a\\u4f20\\u6210\\u529f!',\r\n\t\t'rotate_right' : '\\u5411\\u53f3\\u65cb\\u8f6c',\r\n\t\t'rotate_left' : '\\u5411\\u5de6\\u65cb\\u8f6c',\r\n\t\t'loading' : '\\u6b63\\u5728\\u8f7d\\u5165...',\r\n\t\t'reading' : '\\u6587\\u4ef6\\u8bfb\\u53d6\\u4e2d...',\r\n\t\t'filetype' : '\\u8bf7\\u4e0a\\u4f20{0}\\u6587\\u4ef6!',\r\n\t\t'filenum_limite' : '\\u53ea\\u5141\\u8bb8\\u4e0a\\u4f20{0}\\u4e2a\\u6587\\u4ef6\\uff0c\\u8bf7\\u5220\\u51cf\\u540e\\u91cd\\u8bd5!',\r\n\t\t'hashing' : '\\u6b63\\u5728\\u6548\\u9a8c\\u6587\\u4ef6...',\r\n\t\t'hash_success' : '\\u4e91\\u7aef\\u6587\\u4ef6\\u5df2\\u5b58\\u5728\\uff0c\\u6587\\u4ef6\\u79d2\\u4f20\\u6210\\u529f!',\r\n\t\t'error' : '\\u5931\\u8d25',\r\n\t\t'num_limit' : '\\u53ea\\u80fd\\u4e0a\\u4f20{0}\\u4e2a\\u6587\\u4ef6!',\r\n\t\t'allsize_limit' : '\\u6587\\u4ef6\\u603b\\u5927\\u5c0f\\u8d85\\u51fa!',\r\n\t\t'filesize_limite'  : '\\u6587\\u4ef6\\u5927\\u5c0f\\u8d85\\u51fa {0}!',\r\n\t\t'duplicate' : '\\u4e0a\\u4f20\\u961f\\u5217\\u4e2d\\u6709\\u91cd\\u590d\\u6587\\u4ef6!'\r\n\t};\r\n\tif(typeof $.baseuri == 'undefined')\r\n\t\tthrow('this javascript file need behind \\'common.js\\'');\r\n\t\r\n\t$.fn.extend({\r\n\t\tuploader : function(max_width, max_height, filesize, filetype, filelimit, id) {\r\n\t\t\tvar options = {\r\n\t\t\t\tmax_width: 0,\r\n\t\t\t\tmax_height: 0,\r\n\t\t\t\tfilesize: 2 * 1024 * 1024,\r\n\t\t\t\tfiletype: 'jpg,jpeg,png,bmp,gif,webp,svg',\r\n\t\t\t\tfilelimit: 1,\r\n\t\t\t\tid: null,\r\n\t\t\t};\r\n\t\t\tif (typeof max_width == 'object' && max_width !== null) // it's options\r\n\t\t\t\toptions = $.extend({}, options, max_width);\r\n\t\t\telse if (max_width !== true)\r\n\t\t\t{\r\n\t\t\t\tif (typeof max_width != 'undefined') options.max_width = parseFloat(max_width);\r\n\t\t\t\tif (typeof max_height != 'undefined') options.max_height = parseFloat(max_height);\r\n\t\t\t\tif (typeof filesize != 'undefined') options.filesize = parseFloat(filesize);\r\n\t\t\t\tif (typeof filetype != 'undefined') options.filetype = filetype.toLowerCase();\r\n\t\t\t\tif (typeof filelimit != 'undefined') options.filelimit = parseInt(filelimit);\r\n\t\t\t\tif (typeof id != 'undefined') options.id = id;\r\n\t\t\t}\r\n\t\t\tvar img_types = ['jpg','jpeg','png','bmp','gif','webp','svg'];\r\n\t\t\treturn this.each(function(){\r\n\t\t\t\tvar t = $(this);\r\n\r\n\t\t\t\tvar flex_uploader = t.prop('flex_uploader') ? t.prop('flex_uploader') : {};\r\n\t\t\t\tif (flex_uploader && flex_uploader.uploader)\r\n\t\t\t\t{ //删除原有的控件\r\n\t\t\t\t\tdelete flex_uploader.uploader;\r\n\t\t\t\t\tflex_uploader.$container.remove();\r\n\t\t\t\t\tt.removeProp('flex_uploader');\r\n\t\t\t\t}\r\n\t\t\t\t//删除该控件，下面的不用执行\r\n\t\t\t\tif (max_width === true) return;\r\n\r\n\t\t\t\tvar method = {interval: null};\r\n\t\t\t\tvar nonce = function(){\r\n\t\t\t\t\treturn rand(10000,99999);\r\n\t\t\t\t};\r\n\t\t\t\tvar uploader_id = 'uploader-id-' + nonce(), pick_id = 'pick-id-' + nonce();\r\n\t\t\t\tvar progresses_id = uploader_id + '-progresses', thumbnails_id = uploader_id + '-thumbnails', input_id = uploader_id + '-input';\r\n\t\t\t\t//添加容器到input下\r\n\t\t\t\tflex_uploader.$container = $('<div class=\"uploader-container\" id=\"'+ uploader_id +'\">'+\r\n\t\t\t\t\t'<div class=\"drop-tips text-info\"><h2>'+ $.UPLOADER_LANGUAGE.drop_container +'</h2><br /><br /><div class=\"btn btn-info\" onclick=\"javascript:jQuery(this).parent().hide().parent(\\'.uploader-container\\').removeClass(\\'webuploader-dnd-over\\');\"><i class=\"glyphicon glyphicon-remove\"></i> '+$.UPLOADER_LANGUAGE.close+'</div></div>' +\r\n\t\t\t\t\t'<div class=\"pull-left\"><span id=\"'+ pick_id +'\">'+ $.UPLOADER_LANGUAGE.select_file +'(≤ '+ bytesToSize(options.filesize) +')</span></div>' +\r\n\t\t\t\t\t'<div class=\"pull-left tags\">&nbsp;<span class=\"label label-success\">.' + options.filetype.replace(/,/g,'</span>&nbsp;<span class=\"label label-success\">.') + '</span>' +\r\n\t\t\t\t\t'&nbsp;<!--<span class=\"label label-warning enable-tooltip\" data-placement=\"top\" title=\"'+ $.UPLOADER_LANGUAGE.ctrl_v_tips +'\"><small class=\"glyphicon glyphicon-info-sign\"></small> '+ $.UPLOADER_LANGUAGE.ctrl_v_button +'</span>&nbsp;--><span class=\"label label-warning enable-tooltip\" data-placement=\"top\" title=\"'+ $.UPLOADER_LANGUAGE.drop_container +'\"><small class=\"glyphicon glyphicon-info-sign\"></small> '+ $.UPLOADER_LANGUAGE.drop_button +'</span>' +\r\n\t\t\t\t\t(options.max_width > 0 && options.max_height > 0 ? '<br /><small>&nbsp;'+ $.UPLOADER_LANGUAGE.resize.replace('{0}', options.max_width.toString().toHTML() + 'x' + options.max_height.toString().toHTML()) + '</small>' : '') +\r\n\t\t\t\t\t'</div><div class=\"clearfix\"></div>' +\r\n\t\t\t\t\t'<div id=\"' + progresses_id + '\" class=\"progresses\"></div><div class=\"clearfix\"></div>' +\r\n\t\t\t\t\t'<div id=\"' + thumbnails_id + '\" class=\"thumbnails row\"></div><div class=\"clearfix\"></div>' +\r\n\t\t\t\t\t'</div>').insertAfter(t);\r\n\t\t\t\t\r\n\t\t\t\tif (typeof $.fn.tooltip != 'undefined') $('.enable-tooltip', flex_uploader.$container).tooltip();\r\n\r\n\t\t\t\tvar $progresses = {};\r\n\t\t\t\tvar progress = function(file){\r\n\t\t\t\t\tif (!$progresses[file.id])\r\n\t\t\t\t\t\t$progresses[file.id] = $('<div class=\"media alert alert-warning fade in\"><button type=\"button\" class=\"close\" data-dismiss=\"alert\" aria-label=\"Close\"><span aria-hidden=\"true\">&times;</span></button>' +\r\n\t\t\t\t\t\t\t'<div class=\"media-left media-middle\"><img class=\"media-object\" src=\"\" alt=\"\"></div>' +\r\n\t\t\t\t\t\t\t'<div class=\"media-body\"><h4 class=\"media-heading\">'+file.name.toHTML()+'('+bytesToSize(file.size)+')</h4>' +\r\n\t\t\t\t\t\t\t'<div class=\"media-message\"></div>' +\r\n\t\t\t\t\t\t\t'<div class=\"progress\">' +\r\n\t\t\t\t\t\t\t\t'<div class=\"progress-bar progress-bar-warning progress-bar-striped active\" role=\"progressbar\" aria-valuenow=\"0\" aria-valuemin=\"0\" aria-valuemax=\"100\" style=\"width: 0%\">' +\r\n\t\t\t\t\t\t\t\t\t'<span class=\"\"></span>' +\r\n\t\t\t\t\t\t\t\t'</div>' +\r\n\t\t\t\t\t\t\t'</div>' +\r\n\t\t\t\t\t\t\t'</div>' +\r\n\t\t\t\t\t\t'</div>').appendTo('#'+progresses_id).on('closed.bs.alert', function(){\r\n\t\t\t\t\t\t\tif (file.getStatus() == 'complete')\r\n\t\t\t\t\t\t\t\tprogress(file).remove();\r\n\t\t\t\t\t\t\telse\r\n\t\t\t\t\t\t\t\tprogress(file).cancel();\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\t//console.log(file);\r\n\t\t\t\t\treturn {\r\n\t\t\t\t\t\tinit: function(){\r\n\t\t\t\t\t\t\t$progresses[file.id].removeClass('alert-info alert-danger alert-success alert-warning');\r\n\t\t\t\t\t\t\treturn this;\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tinitProgress: function(){\r\n\t\t\t\t\t\t\t $('.progress-bar', $progresses[file.id]).removeClass('progress-bar-info progress-bar-danger progress-bar-success progress-bar-warning');\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tthumb: function(){\r\n\t\t\t\t\t\t\tflex_uploader.uploader.makeThumb( file, function( error, ret ) {\r\n\t\t\t\t\t\t\t\t$('.media-object', $progresses[file.id]).attr('src', error ? $.baseuri+'placeholder?text='+file.ext+'&size=75x75&fontsize=35' : ret);\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tname: function(name){\r\n\t\t\t\t\t\t\t$('.progressName', $progresses[file.id]).html(name.toHTML());\r\n\t\t\t\t\t\t\treturn this;\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tmessage: function(message){\r\n\t\t\t\t\t\t\t$('.media-message', $progresses[file.id]).html(message);\r\n\t\t\t\t\t\t\treturn this;\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\terror: function(message) {\r\n\t\t\t\t\t\t\tthis.init();\r\n\t\t\t\t\t\t\tthis.initProgress();\r\n\t\t\t\t\t\t\tfile.setStatus('invalid');\r\n\t\t\t\t\t\t\t$progresses[file.id].addClass(\"alert-danger\");\r\n\t\t\t\t\t\t\t$('.progress-bar', $progresses[file.id]).addClass(\"progress-bar-danger\");\r\n\t\t\t\t\t\t\treturn this.message(message);\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tprogressing: function (percentage, is_hashing) {\r\n\t\t\t\t\t\t\tthis.init();\r\n\t\t\t\t\t\t\tthis.initProgress();\r\n\t\t\t\t\t\t\t$progresses[file.id].addClass(\"alert-info\");\r\n\t\t\t\t\t\t\tpercentage = percentage.toFixed(2);\r\n\t\t\t\t\t\t\tvar $bar = $('.progress-bar', $progresses[file.id]).width(percentage + \"%\");\r\n\t\t\t\t\t\t\t$('.progress-bar span', $progresses[file.id]).text(percentage + \"%\");\r\n\t\t\t\t\t\t\tif (percentage < 20)\r\n\t\t\t\t\t\t\t\t$bar.addClass('progress-bar-warning');\r\n\t\t\t\t\t\t\telse if (percentage < 95)\r\n\t\t\t\t\t\t\t\t$bar.addClass('progress-bar-info');\r\n\t\t\t\t\t\t\telse\r\n\t\t\t\t\t\t\t\t$bar.addClass('progress-bar-success');\r\n\t\t\t\t\t\t\tif (percentage < 100) $bar.addClass('active'); else $bar.removeClass('active');\r\n\t\t\t\t\t\t\treturn this.message($.UPLOADER_LANGUAGE.uploading);\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tsuccess: function() {\r\n\t\t\t\t\t\t\tthis.progressing(100);\r\n\t\t\t\t\t\t\tthis.init();\r\n\t\t\t\t\t\t\t$progresses[file.id].addClass(\"alert-success\");\r\n\r\n\t\t\t\t\t\t\t$progresses[file.id].delay(1500).queue(function(){\r\n\t\t\t\t\t\t\t\t$(this).alert('close').dequeue();\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\treturn this.message($.UPLOADER_LANGUAGE.success);\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tcancel: function() {\r\n\t\t\t\t\t\t\tflex_uploader.uploader.cancelFile(file);\r\n\t\t\t\t\t\t\treturn this.remove();\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tremove: function() {\r\n\t\t\t\t\t\t\t$progresses[file.id].remove();\r\n\t\t\t\t\t\t\tdelete $progresses[file.id];\r\n\t\t\t\t\t\t\treturn this;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t};\r\n\t\t\t\t};\r\n\t\t\t\tvar $thumbnails = {};\r\n\t\t\t\tvar preview = function(id, filename, fileext)\r\n\t\t\t\t{\r\n\t\t\t\t\tif (typeof id != 'undefined' && typeof $thumbnails[id] == 'undefined')\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\t$thumbnails[id] = $('<div class=\"col-xs-6 col-md-4 alert\"><div class=\"thumbnail\">' +\r\n\t\t\t\t\t\t\t'<div class=\"file-panel\"><span class=\"cancel\" data-dismiss=\"alert\" aria-label=\"Close\">'+$.UPLOADER_LANGUAGE.close+'</span><span class=\"rotateRight\">'+$.UPLOADER_LANGUAGE.rotate_right+'</span><span class=\"rotateLeft\">'+$.UPLOADER_LANGUAGE.rotate_left+'</span></div>' +\r\n\t\t\t\t\t\t\t'<a href=\"'+$.baseuri+'attachment?id='+id+'\"  target=\"_blank\"><img src=\"'+$.baseuri+'placeholder?size=300x200&text='+encodeURIComponent($.UPLOADER_LANGUAGE.loading)+'\" alt=\"\" class=\"img-responsive center-block\"  onerror=\"this.src=\\''+ $.baseuri +'placeholder?size=300x200&text=\\'+encodeURIComponent(\\''+$.UPLOADER_LANGUAGE.reading+'\\');\"></a>' +\r\n\t\t\t\t\t\t\t'<div class=\"caption\">' +\r\n        \t\t\t\t\t'<h4><span class=\"title\">'+(filename ? filename.toHTML() : '')+'</span><button type=\"button\" class=\"close\" data-dismiss=\"alert\" aria-label=\"Close\"><span aria-hidden=\"true\">&times;</span></button></h4>' +\r\n\t\t\t\t\t\t\t'</div><div class=\"clearfix\"></div>' +\r\n\t\t\t\t\t\t\t'</div><div class=\"clearfix\"></div></div>').appendTo('#' + thumbnails_id).on('closed.bs.alert', function(){\r\n\t\t\t\t\t\t\t\tpreview(id).remove();\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t$('.rotateLeft,.rotateRight', $thumbnails[id]).on('click', function(){\r\n\t\t\t\t\t\t\t\tvar rotation = parseInt($thumbnails[id].data('rotation')) || 0;\r\n\t\t\t\t\t\t\t\trotation += $(this).is('.rotateLeft') ? -90 : 90;\r\n\t\t\t\t\t\t\t\tdeg = 'rotate(' + rotation + 'deg)';\r\n\t\t\t\t\t\t\t\t$('img', $thumbnails[id]).css(\r\n\t\t\t\t\t\t\t\t\t$.supportTransition ? {'-webkit-transform': deg,'-mos-transform': deg,'-o-transform': deg,'transform': deg}\r\n\t\t\t\t\t\t\t\t     : {filter: 'progid:DXImageTransform.Microsoft.BasicImage(rotation='+ (~~((rotation/90)%4 + 4)%4) +')'}\r\n\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t\t$thumbnails[id].data('rotation', rotation);\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\tif (!fileext) \r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t$.GET($.baseuri + 'attachment/info?id='+ id, null, function(json){\r\n\t\t\t\t\t\t\t\tif (typeof json != 'undefined' && (json.result == 'success' || json.result == 'api') && typeof json.data.ext != 'undefined')\r\n\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\tvar pic = img_types.indexOf(json.data.ext.toLowerCase()) > -1 ? $.baseuri + 'attachment/preview?id='+ id : $.baseuri + 'placeholder?size=300x200&text='+encodeURIComponent(json.data.ext);\r\n\t\t\t\t\t\t\t\t\t$('.title', $thumbnails[id]).text(json.data.displayname);\r\n\t\t\t\t\t\t\t\t\t$('img', $thumbnails[id]).attr('src',pic);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tvar pic = img_types.indexOf(fileext.toLowerCase()) > -1 ? $.baseuri + 'attachment/preview?id='+ id: $.baseuri + 'placeholder?size=300x200&text='+ encodeURIComponent(fileext);\r\n\t\t\t\t\t\t\t$('img', $thumbnails[id]).attr('src',pic);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\treturn {\r\n\t\t\t\t\t\tbuild: function(){\r\n\t\t\t\t\t\t\tif (t.triggerHandler('uploader.previewing', [this.getFile(), id, attachment().get()]) === false) return this;\r\n\t\t\t\t\t\t\tattachment().add(id);\r\n\t\t\t\t\t\t\tt.triggerHandler('uploader.previewed',[this.getFile(), id, attachment().get()]);\r\n\t\t\t\t\t\t\treturn this;\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tremove: function(){\r\n\t\t\t\t\t\t\tvar file = this.getFile();\r\n\t\t\t\t\t\t\tif (t.triggerHandler('uploader.removing', [file, id, attachment().get()]) === false) return this;\r\n\t\t\t\t\t\t\tif (file) flex_uploader.uploader.removeFile(file, true);\r\n\t\t\t\t\t\t\tattachment().remove(id);\r\n\t\t\t\t\t\t\t$thumbnails[id].remove();\r\n\t\t\t\t\t\t\tdelete $thumbnails[id];\r\n\t\t\t\t\t\t\tt.triggerHandler('uploader.removed',[file, id, attachment().get()]);\r\n\t\t\t\t\t\t\treturn this;\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tsetFile: function(file){\r\n\t\t\t\t\t\t\t$thumbnails[id].data(\"file\", file);\r\n\t\t\t\t\t\t\treturn this;\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tgetFile: function(){\r\n\t\t\t\t\t\t\treturn $thumbnails[id].data(\"file\");\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tremoveAll: function(){\r\n\t\t\t\t\t\t\tfor (var id in $thumbnails) {\r\n\t\t\t\t\t\t\t\tpreview(id).remove();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\trebuildAll: function() {\r\n\t\t\t\t\t\t\t//remove all files\r\n\t\t\t\t\t\t\tfiles = flex_uploader.uploader.getFiles();\r\n\t\t\t\t\t\t\tfor(var i = 0;i < files.length;i++)\r\n\t\t\t\t\t\t\t\tflex_uploader.uploader.removeFile(files[i], true);\r\n\t\t\t\t\t\t\t//remove all preview\r\n\t\t\t\t\t\t\tthis.removeAll();\r\n\t\t\t\t\t\t\t//build\r\n\t\t\t\t\t\t\tvar aids = attachment().get();\r\n\t\t\t\t\t\t\tfor (i = 0; i < aids.length; i++) {\r\n\t\t\t\t\t\t\t\tpreview(aids[i]).build();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\treturn this;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t};\r\n\t\t\t\t};\r\n\t\t\t\tvar attachment = function() {\r\n\t\t\t\t\tvar aid = t.val();\r\n\t\t\t\t\tif (aid == '0') aid = '';\r\n\t\t\t\t\taids = aid ? ( aid instanceof Array ? aid : aid.split(',') ) : [];\r\n\t\t\t\t\treturn {\r\n\t\t\t\t\t\twrite: function() {\r\n\t\t\t\t\t\t\tif (t.is('select')){\r\n\t\t\t\t\t\t\t\tt.empty();\r\n\t\t\t\t\t\t\t\taids.forEach(function(i){\r\n\t\t\t\t\t\t\t\t\tt.append('<option value=\"'+i+'\">'+i+'</option>');\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tt.val(aids);\r\n\t\t\t\t\t\t\treturn this;\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tadd: function(id) {\r\n\t\t\t\t\t\t\tif (options.filelimit == 1) aids = [id.toString()];\r\n\t\t\t\t\t\t\tvar i = aids.indexOf(id.toString());\r\n\t\t\t\t\t\t\tif (i == -1) aids.push(id.toString());\r\n\t\t\t\t\t\t\treturn this.write();\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tremove: function(id) {\r\n\t\t\t\t\t\t\tvar i = aids.indexOf(id.toString());\r\n\t\t\t\t\t\t\tif (i != -1) aids.splice(i,1);\r\n\t\t\t\t\t\t\treturn this.write();\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tremoveAll: function(){\r\n\t\t\t\t\t\t\taids = [];\r\n\t\t\t\t\t\t\treturn this.write();\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tget: function(){\r\n\t\t\t\t\t\t\treturn aids;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t};\r\n\t\t\t\t};\r\n\r\n\r\n\t\t\t\t//---------------------------------------\r\n\t\t\t\tmethod.beforeFileQueued = function(file) {\r\n\t\t\t\t\tif (options.filetype.split(',').indexOf(file.ext.toLowerCase()) == -1){\r\n\t\t\t\t\t\t$.alert($.UPLOADER_LANGUAGE.filetype.replace('{0}', options.filetype));\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (options.filelimit > 1 &&  attachment().get().length >= options.filelimit) {\r\n\t\t\t\t\t\t$.alert($.UPLOADER_LANGUAGE.filenum_limite.replace('{0}', options.filelimit));\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t};\r\n\t\t\t\tmethod.fileQueued = function(file) {\r\n\t\t\t\t\tif (t.triggerHandler('uploader.uploading', [file, attachment().get()]) === false) return false;\r\n\t\t\t\t\tprogress(file).init().thumb();\r\n\r\n\t\t\t\t\t//前台压缩图片，检查的是源文件的MD5，而非压缩之后的，所以直接上传。另外：压缩之后的图片暂时无法检查BUG\r\n\t\t\t\t\tif (options.max_width > 0 && options.max_height > 0 && (file.ext == 'jpg' || file.ext == 'jpeg'))\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tflex_uploader.uploader.upload(file);\r\n\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tthis.md5File( file ).progress(function(percentage) {\r\n\t\t\t\t\t\tprogress(file).progressing(0).message($.UPLOADER_LANGUAGE.hashing + ' ' + (percentage * 100).toFixed(2) + '%');\r\n\t\t\t\t\t}).then(function(val) {\r\n\t\t\t\t\t\t$.POST($.baseuri + 'attachment/hash_query', {\r\n\t\t\t\t\t\t\thash: val,\r\n\t\t\t\t\t\t\t_token: $.csrf,\r\n\t\t\t\t\t\t\tfilename: file.name,\r\n\t\t\t\t\t\t\text: file.ext,\r\n\t\t\t\t\t\t\tsize: file.size\r\n\t\t\t\t\t\t}, function(json){\r\n\t\t\t\t\t\t\tif (typeof json != 'undefined' && (json.result == 'success' || json.result == 'api')){\r\n\t\t\t\t\t\t\t\tflex_uploader.uploader.skipFile(file);\r\n\t\t\t\t\t\t\t\tprogress(file).success().message($.UPLOADER_LANGUAGE.hash_success);\r\n\t\t\t\t\t\t\t\tif (options.filelimit == 1) preview().removeAll();\r\n\t\t\t\t\t\t\t\tpreview(json.data.id, json.data.displayname, json.data.ext).build().setFile(file);\r\n\t\t\t\t\t\t\t\tt.triggerHandler('uploader.uploaded',[file, json, attachment().get()]);\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tfile.md5 = val;\r\n\t\t\t\t\t\t\t\tflex_uploader.uploader.upload(file);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t},false);\r\n\t\t\t\t\t});\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t};\r\n\t\t\t\tmethod.uploadBeforeSend = function(obj, data, headers) {\r\n\t\t\t\t\t//console.log(obj);\r\n\t\t\t\t\tdata.uuid = obj.blob.ruid + obj.file.id + obj.file.size;\r\n\t\t\t\t\tdata.start = obj.start;\r\n\t\t\t\t\tdata.end = obj.end;\r\n\t\t\t\t\tdata.chunks = obj.chunks;\r\n\t\t\t\t\tdata.chunk = obj.chunk;\r\n\t\t\t\t\tdata.total = obj.file.size;\r\n\t\t\t\t\tdata.hash = obj.file.md5;\r\n\t\t\t\t};\r\n\t\t\t\tmethod.uploadStart = function(file) {\r\n\t\t\t\t\t\r\n\t\t\t\t};\r\n\t\t\t\t//上传过程中触发，携带上传进度。\r\n\t\t\t\tmethod.uploadProgress = function(file, percentage) {\r\n\t\t\t\t\tt.triggerHandler('uploader.progressing',[file, percentage, attachment().get()]);\r\n\t\t\t\t\tprogress(file).progressing(percentage);\r\n\t\t\t\t};\r\n\t\t\t\t//当文件上传成功时触发。\r\n\t\t\t\tmethod.uploadSuccess = function(file, json) {\r\n\t\t\t\t\tif (json && (json.result == 'success' || json.result == 'api')) {\r\n\t\t\t\t\t\tprogress(file).success();\r\n\t\t\t\t\t\tif (options.filelimit == 1) preview().removeAll();\r\n\t\t\t\t\t\tpreview(json.data.id, json.data.displayname, json.data.ext).build().setFile(file);\r\n\t\t\t\t\t\tt.triggerHandler('uploader.uploaded',[file, json, attachment().get()]);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tprogress(file).error($.UPLOADER_LANGUAGE.error+': ' + json.message.content);\r\n\t\t\t\t\t\tt.triggerHandler('uploader.error',[file, json.message.content, attachment().get()]);\r\n\t\t\t\t\t\t//$.alert(json.message.content);\r\n\t\t\t\t\t}\r\n\t\t\t\t};\r\n\t\t\t\t\r\n\t\t\t\t//当文件上传出错时触发。\r\n\t\t\t\tmethod.uploadError = function(file, reason) {\r\n\t\t\t\t\tprogress(file).error($.UPLOADER_LANGUAGE.error+': ' + reason);\r\n\t\t\t\t\tt.triggerHandler('uploader.error',[file, reason, attachment().get()]);\r\n\t\t\t\t};\r\n\t\t\t\t//不管成功或者失败，文件上传完成时触发。\r\n\t\t\t\tmethod.uploadComplete = function(file) {\r\n\t\t\t\t\t\r\n\t\t\t\t};\r\n\t\t\t\tmethod.error = function(code, max, file) {\r\n\t\t\t\t\tswitch(code)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tcase 'Q_EXCEED_NUM_LIMIT':\r\n\t\t\t\t\t\t\t$.alert($.UPLOADER_LANGUAGE.num_limit.replace('{0}', max));\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'Q_EXCEED_SIZE_LIMIT':\r\n\t\t\t\t\t\t\t$.alert($.UPLOADER_LANGUAGE.allsize_limit);\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'F_EXCEED_SIZE':\r\n\t\t\t\t\t\t\t$.alert($.UPLOADER_LANGUAGE.filesize_limite.replace('{0}', bytesToSize(options.filesize)));\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'F_DUPLICATE':\r\n\t\t\t\t\t\t\t$.alert($.UPLOADER_LANGUAGE.duplicate);\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'Q_TYPE_DENIED':\r\n\t\t\t\t\t\t\t$.alert($.UPLOADER_LANGUAGE.filetype.replace('{0}', options.filetype));\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tdefault:\r\n\t\t\t\t\t\t\t$.alert(code);\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t};\r\n\r\n\t\t\t\tmethod.create = function()\r\n\t\t\t\t{\r\n\t\t\t\t\tif (flex_uploader.uploader || typeof t.prop('flex_uploader') == 'undefined' || typeof t.prop('flex_uploader').uploader != 'undefined') return;\r\n\t\t\t\t\tflex_uploader.uploader = WebUploader.create({\r\n\t\t\t\t\t\t// swf文件路径\r\n\t\t\t\t\t\tswf: $.baseuri + \"static/js/webuploader/Uploader.swf\",\r\n\t\t\t\t\t\t// 文件接收服务端。\r\n\t\t\t\t\t\tserver: $.baseuri + \"attachment/uploader_query?of=json\",\r\n\t\t\t\t\t\t// 选择文件的按钮。可选。内部根据当前运行是创建，可能是input元素，也可能是flash\r\n\t\t\t\t\t\tpick: {\r\n\t\t\t\t\t\t\tid: document.getElementById(pick_id),\r\n\t\t\t\t\t\t\tmultiple: true\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\t//表单附加数据\r\n\t\t\t\t\t\tformData: $.extend($.session_id ? {\"PHPSESSIONID\": $.session_id} : {}, $.csrf ? {'_token': $.csrf} : {}, {}),\r\n\t\t\t\t\t\t//文件表单name\r\n\t\t\t\t\t\tfileVal: 'Filedata',\r\n\t\t\t\t\t\t//METHOD\r\n\t\t\t\t\t\tmethod: 'POST',\r\n\t\t\t\t\t\t//二进制上传，php://input都为文件内容，其他参数在$_GET中\r\n\t\t\t\t\t\tsendAsBinary: false,\r\n\t\t\t\t\t\t//可提交文件数量限制\r\n\t\t\t\t\t\tfileNumLimit: 0,\r\n\t\t\t\t\t\t//总文件大小限制\r\n\t\t\t\t\t\t//fileSizeLimit: 1024 * 1024 * 1024, //1G\r\n\t\t\t\t\t\t//单文件大小限制\r\n\t\t\t\t\t\tfileSingleSizeLimit: options.filesize,\r\n\t\t\t\t\t\t//是否去重\r\n\t\t\t\t\t\tduplicate: false,\r\n\t\t\t\t\t\t// 文件选择筛选。\r\n\t\t\t\t\t\taccept: {\r\n\t\t\t\t\t\t\ttitle: $.UPLOADER_LANGUAGE.select_file,\r\n\t\t\t\t\t\t\textensions: options.filetype,\r\n\t\t\t\t\t\t\tmimeTypes: typeof mimeType != 'undefined' ? options.filetype.split(',').map(function(v){return mimeType.lookup('name.' + v);}).join(',') : '*/*'\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\t//是否允许在文件传输时提前把下一个文件的分片,MD5准备好\r\n\t\t\t\t\t\tprepareNextFile: true,\r\n\t\t\t\t\t\t//分多大一片？ 默认大小为5M.\r\n\t\t\t\t\t\tchunkSize: 5242880,\r\n\t\t\t\t\t\t//分片允许自动重传多少次\r\n\t\t\t\t\t\tchunkRetry: 5,\r\n\t\t\t\t\t\t//是否分片上传。\r\n\t\t\t\t\t\tchunked: true,\r\n\t\t\t\t\t\t//同时上传并发数\r\n\t\t\t\t\t\tthreads: 3,\r\n\t\t\t\t\t\t//指定拖拽的容器\r\n\t\t\t\t\t\tdnd: document.getElementById(uploader_id),\r\n\t\t\t\t\t\t//全局禁用拉拽，防止默认打开文件\r\n\t\t\t\t\t\tdisableGlobalDnd: true,\r\n\t\t\t\t\t\t//可以粘贴的容器\r\n\t\t\t\t\t\t//paste: document.getElementById(uploader_id),\r\n\t\t\t\t\t\tthumb: {// 缩略图\r\n\t\t\t\t\t\t\twidth: 75,\r\n\t\t\t\t\t\t\theight: 75,\r\n\t\t\t\t\t\t\t// 图片质量，只有type为`image/jpeg`的时候才有效。\r\n\t\t\t\t\t\t\tquality: 70,\r\n\t\t\t\t\t\t\t// 是否允许放大，如果想要生成小图的时候不失真，此选项应该设置为false.\r\n\t\t\t\t\t\t\tallowMagnify: false,\r\n\t\t\t\t\t\t\t// 是否允许裁剪。\r\n\t\t\t\t\t\t\tcrop: true,\r\n\t\t\t\t\t\t\t// 为空的话则保留原有图片格式。\r\n\t\t\t\t\t\t\t// 否则强制转换成指定的类型。\r\n\t\t\t\t\t\t\t//type: 'image/jpeg'\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\t// 不压缩image, 默认如果是jpeg，文件上传前会压缩一把再上传！\r\n\t\t\t\t\t\tresize: false,\r\n\t\t\t\t\t\tcompress: null\r\n\t\t\t\t\t});\r\n\t\t\t\t\t// 修改后图片上传前，尝试将图片压缩到max_width * max_height\r\n\t\t\t\t\tif (options.max_width > 0 && options.max_height > 0)\r\n\t\t\t\t\t\tflex_uploader.uploader.option( 'compress', {\r\n\t\t\t\t\t\t\twidth: options.max_width,\r\n\t\t\t\t\t\t\theight: options.max_height,\r\n\t\t\t\t\t\t\t// 图片质量，只有type为`image/jpeg`的时候才有效。\r\n\t\t\t\t\t\t\tquality: 100,\r\n\t\t\t\t\t\t\t// 是否允许放大，如果想要生成小图的时候不失真，此选项应该设置为false.\r\n\t\t\t\t\t\t\tallowMagnify: false,\r\n\t\t\t\t\t\t\t// 是否允许裁剪。\r\n\t\t\t\t\t\t\tcrop: false,\r\n\t\t\t\t\t\t\t// 是否保留头部meta信息。\r\n\t\t\t\t\t\t\tpreserveHeaders: true,\r\n\t\t\t\t\t\t\t// 如果发现压缩后文件大小比原来还大，则使用原来图片。此属性可能会影响图片自动纠正功能\r\n\t\t\t\t\t\t\tnoCompressIfLarger: true,\r\n\t\t\t\t\t\t\t// 单位字节，如果图片大小小于此值，不会采用压缩。\r\n\t\t\t\t\t\t\tcompressSize: 0\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\tflex_uploader.uploader.on('beforeFileQueued', method.beforeFileQueued);\r\n\t\t\t\t\tflex_uploader.uploader.on('fileQueued', method.fileQueued);\r\n\t\t\t\t\tflex_uploader.uploader.on('uploadBeforeSend', method.uploadBeforeSend);\r\n\t\t\t\t\tflex_uploader.uploader.on('uploadStart', method.uploadStart);\r\n\t\t\t\t\tflex_uploader.uploader.on('uploadProgress', method.uploadProgress);\r\n\t\t\t\t\tflex_uploader.uploader.on('uploadSuccess', method.uploadSuccess);\r\n\t\t\t\t\tflex_uploader.uploader.on('uploadError', method.uploadError);\r\n\t\t\t\t\tflex_uploader.uploader.on('uploadComplete', method.uploadComplete);\r\n\t\t\t\t\tflex_uploader.uploader.on('error', method.error);\r\n\r\n\t\t\t\t\tt.prop('flex_uploader', flex_uploader);\r\n\t\t\t\t\t//init\r\n\t\t\t\t\tif(options.id) attachment().add(options.id);\r\n\t\t\t\t\tpreview().rebuildAll();\r\n\t\t\t\t};\r\n\r\n\t\t\t\tt.prop('flex_uploader', flex_uploader);\r\n\r\n\t\t\t\tif (!flex_uploader.$container.is(':visible')/* flex_uploader.$container[0].offsetParent === null*/) { //默认没有显示出来，需要特殊处理\r\n\t\t\t\t\tmethod.interval = setInterval(function(){\r\n\t\t\t\t\t\tif (flex_uploader.$container.is(':visible'))\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tclearInterval(method.interval);\r\n\t\t\t\t\t\t\tmethod.create();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}, 500); //还能有更好的方法吗? MutationObserver?\r\n\r\n\t\t\t\t} else {\r\n\t\t\t\t\tmethod.create();\r\n\t\t\t\t}\r\n\r\n\t\t\t});\r\n\t\t\t\r\n\t\t}\r\n\t});\r\n})(jQuery);"]}