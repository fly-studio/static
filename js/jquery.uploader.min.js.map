{"version":3,"sources":["jquery.uploader.js"],"names":["$","UPLOADER_LANGUAGE","close","drop_container","drop_tips","drop_button","select_file","ctrl_v_tips","ctrl_v_button","resize","uploading","success","rotate_right","rotate_left","loading","reading","filetype","filenum_limite","hashing","hash_success","error","num_limit","allsize_limit","filesize_limite","duplicate","baseuri","scripts","document","getElementsByTagName","querys","deparam","querystring","length","src","session_id","fn","extend","uploader","max_width","max_height","filesize","filelimit","id","max_widt","parseFloat","max_heigh","filesiz","filetyp","toLowerCase","isNaN","parseInt","img_types","this","each","t","flex_uploader","prop","$container","remove","removeProp","method","nonce","rand","uploader_id","pick_id","progresses_id","thumbnails_id","bytesToSize","replace","toString","toHTML","insertAfter","tooltip","$progresses","progress","file","name","size","appendTo","on","getStatus","cancel","init","removeClass","initProgress","thumb","makeThumb","ret","attr","ext","html","message","setStatus","addClass","progressing","percentage","is_hashing","toFixed","$bar","width","text","delay","queue","alert","dequeue","cancelFile","$thumbnails","preview","filename","fileext","encodeURIComponent","rotation","data","is","deg","css","supportTransition","-webkit-transform","-mos-transform","-o-transform","transform","filter","pic","indexOf","GET","json","result","displayname","build","triggerHandler","getFile","attachment","get","add","removeFile","setFile","removeAll","rebuildAll","files","getFiles","i","aids","aid","val","Array","split","write","empty","forEach","append","push","splice","beforeFileQueued","fileQueued","upload","md5File","then","POST","hash","_token","csrf","md5","skipFile","uploadBeforeSend","obj","headers","uuid","blob","ruid","start","end","chunks","chunk","total","uploadStart","uploadProgress","uploadSuccess","content","uploadError","reason","uploadComplete","code","max","create","WebUploader","swf","server","pick","multiple","formData","PHPSESSIONID","fileVal","sendAsBinary","fileNumLimit","fileSingleSizeLimit","accept","title","extensions","mimeTypes","mimeType","map","v","lookup","join","prepareNextFile","chunkSize","chunkRetry","chunked","threads","dnd","disableGlobalDnd","paste","body","height","quality","allowMagnify","crop","compress","option","preserveHeaders","noCompressIfLarger","compressSize","interval","setInterval","clearInterval","jQuery"],"mappings":"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","file":"jquery.uploader.min.js","sourcesContent":["(function($){\r\n\t$.UPLOADER_LANGUAGE = {\r\n\t\t'close' : '\\u5173\\u95ed',\r\n\t\t'drop_container' : '\\u62d6\\u5230\\u6587\\u4ef6\\u5230\\u8fd9\\u91cc',\r\n\t\t'drop_tips' : '\\u652f\\u6301\\u4eceWindows\\u4e2d\\u62d6\\u52a8\\u6587\\u4ef6\\u5230\\u8fd9\\u91cc\\u4e0a\\u4f20\\uff08\\u9700\\u73b0\\u4ee3\\u6d4f\\u89c8\\u5668\\uff09',\r\n\t\t'drop_button' : '\\u62d6\\u653e\\u6587\\u4ef6',\r\n\t\t'select_file' : '\\u9009\\u62e9\\u6587\\u4ef6',\r\n\t\t'ctrl_v_tips' : '\\u53ef\\u4ee5\\u4f7f\\u7528Ctrl+V\\u76f4\\u63a5\\u7c98\\u8d34\\u622a\\u56fe\\uff08\\u9700\\u73b0\\u4ee3\\u6d4f\\u89c8\\u5668\\uff09',\r\n\t\t'ctrl_v_button' : 'Ctrl+V \\u622a\\u56fe',\r\n\t\t'resize' : '\\u56fe\\u7247\\u4f1a\\u81ea\\u52a8\\u7b49\\u6bd4\\u7f29\\u653e\\u81f3\\uff1a{0} (\\u4ec5jpg)',\r\n\t\t'uploading' : '\\u6b63\\u5728\\u4e0a\\u4f20\\u6587\\u4ef6...',\r\n\t\t'success' : '\\u4e0a\\u4f20\\u6210\\u529f!',\r\n\t\t'rotate_right' : '\\u5411\\u53f3\\u65cb\\u8f6c',\r\n\t\t'rotate_left' : '\\u5411\\u5de6\\u65cb\\u8f6c',\r\n\t\t'loading' : '\\u6b63\\u5728\\u8f7d\\u5165...',\r\n\t\t'reading' : '\\u6587\\u4ef6\\u8bfb\\u53d6\\u4e2d...',\r\n\t\t'filetype' : '\\u8bf7\\u4e0a\\u4f20{0}\\u6587\\u4ef6!',\r\n\t\t'filenum_limite' : '\\u53ea\\u5141\\u8bb8\\u4e0a\\u4f20{0}\\u4e2a\\u6587\\u4ef6\\uff0c\\u8bf7\\u5220\\u51cf\\u540e\\u91cd\\u8bd5!',\r\n\t\t'hashing' : '\\u6b63\\u5728\\u6548\\u9a8c\\u6587\\u4ef6...',\r\n\t\t'hash_success' : '\\u4e91\\u7aef\\u6587\\u4ef6\\u5df2\\u5b58\\u5728\\uff0c\\u6587\\u4ef6\\u79d2\\u4f20\\u6210\\u529f!',\r\n\t\t'error' : '\\u5931\\u8d25',\r\n\t\t'num_limit' : '\\u53ea\\u80fd\\u4e0a\\u4f20{0}\\u4e2a\\u6587\\u4ef6!',\r\n\t\t'allsize_limit' : '\\u6587\\u4ef6\\u603b\\u5927\\u5c0f\\u8d85\\u51fa!',\r\n\t\t'filesize_limite'  : '\\u6587\\u4ef6\\u5927\\u5c0f\\u8d85\\u51fa {0}!',\r\n\t\t'duplicate' : '\\u4e0a\\u4f20\\u961f\\u5217\\u4e2d\\u6709\\u91cd\\u590d\\u6587\\u4ef6!'\r\n\t};\r\n\tif(typeof $.baseuri == 'undefined')\r\n\t\tthrow('this javascript file need behind \\'common.js\\'');\r\n\tvar scripts = document.getElementsByTagName(\"script\");\r\n\tvar querys = $.deparam.querystring((scripts[ scripts.length - 1 ]).src);\r\n\t$.session_id = querys.session_id;\r\n\t\r\n\t$.fn.extend({\r\n\t\tuploader : function(max_width, max_height, filesize, filetype, filelimit, id) {\r\n\t\t\tif (max_width !== true)\r\n\t\t\t\tmax_width = typeof max_widt == 'undefined' ? 0 : parseFloat(max_width);\r\n\t\t\tmax_height = typeof max_heigh == 'undefined' ? 0 : parseFloat(max_height);\r\n\t\t\tfilesize = typeof filesiz == 'undefined' ? 2 * 1024 * 1024 : filesize; //2 MB\r\n\t\t\tfiletype = typeof filetyp == 'undefined' ? 'jpg,jpeg,png,bmp,gif,webp,svg' : filetype.toLowerCase();\r\n\t\t\tfilelimit = isNaN(filelimit) ? 1 : parseInt(filelimit);\r\n\t\t\tvar img_types = ['jpg','jpeg','png','bmp','gif','webp','svg'];\r\n\t\t\treturn this.each(function(){\r\n\t\t\t\tvar t = $(this);\r\n\r\n\t\t\t\tvar flex_uploader = t.prop('flex_uploader') ? t.prop('flex_uploader') : {};\r\n\t\t\t\tif (flex_uploader && flex_uploader.uploader)\r\n\t\t\t\t{ //删除原有的控件\r\n\t\t\t\t\tdelete flex_uploader.uploader;\r\n\t\t\t\t\tflex_uploader.$container.remove();\r\n\t\t\t\t\tt.removeProp('flex_uploader');\r\n\t\t\t\t}\r\n\t\t\t\t//删除该控件，下面的不用执行\r\n\t\t\t\tif (max_width === true) return;\r\n\r\n\t\t\t\tvar method = {};\r\n\t\t\t\tvar nonce = function(){\r\n\t\t\t\t\treturn rand(10000,99999);\r\n\t\t\t\t};\r\n\t\t\t\tvar uploader_id = 'uploader-id-' + nonce(), pick_id = 'pick-id-' + nonce();\r\n\t\t\t\tvar progresses_id = uploader_id + '-progresses', thumbnails_id = uploader_id + '-thumbnails', input_id = uploader_id + '-input';\r\n\t\t\t\t//添加容器到input下\r\n\t\t\t\tflex_uploader.$container = $('<div class=\"uploader-container\" id=\"'+ uploader_id +'\">'+\r\n\t\t\t\t\t'<div class=\"drop-tips text-info\"><h2>'+ $.UPLOADER_LANGUAGE.drop_container +'</h2><br /><br /><div class=\"btn btn-info\" onclick=\"javascript:jQuery(this).parent().hide().parent(\\'.uploader-container\\').removeClass(\\'webuploader-dnd-over\\');\"><i class=\"glyphicon glyphicon-remove\"></i> '+$.UPLOADER_LANGUAGE.close+'</div></div>' +\r\n\t\t\t\t\t'<div class=\"pull-left\"><span id=\"'+ pick_id +'\">'+ $.UPLOADER_LANGUAGE.select_file +'(≤ '+ bytesToSize(filesize) +')</span></div>' +\r\n\t\t\t\t\t'<div class=\"pull-left tags\">&nbsp;<span class=\"label label-success\">.' + filetype.replace(/,/g,'</span>&nbsp;<span class=\"label label-success\">.') + '</span>' +\r\n\t\t\t\t\t'&nbsp;<span class=\"label label-warning enable-tooltip\" data-placement=\"top\" title=\"'+ $.UPLOADER_LANGUAGE.ctrl_v_tips +'\"><small class=\"glyphicon glyphicon-info-sign\"></small> '+ $.UPLOADER_LANGUAGE.ctrl_v_button +'</span>&nbsp;<span class=\"label label-warning enable-tooltip\" data-placement=\"top\" title=\"'+ $.UPLOADER_LANGUAGE.drop_container +'\"><small class=\"glyphicon glyphicon-info-sign\"></small> '+ $.UPLOADER_LANGUAGE.drop_button +'</span>' +\r\n\t\t\t\t\t(max_width > 0 && max_height > 0 ? '<br /><small>&nbsp;'+ $.UPLOADER_LANGUAGE.resize.replace('{0}', max_width.toString().toHTML() + 'x' + max_height.toString().toHTML()) + '</small>' : '') +\r\n\t\t\t\t\t'</div><div class=\"clearfix\"></div>' +\r\n\t\t\t\t\t'<div id=\"' + progresses_id + '\" class=\"progresses\"></div><div class=\"clearfix\"></div>' +\r\n\t\t\t\t\t'<div id=\"' + thumbnails_id + '\" class=\"thumbnails row\"></div><div class=\"clearfix\"></div>' +\r\n\t\t\t\t\t'</div>').insertAfter(t);\r\n\t\t\t\t\r\n\t\t\t\tif (typeof $.fn.tooltip != 'undefined') $('.enable-tooltip', flex_uploader.$container).tooltip();\r\n\r\n\t\t\t\tvar $progresses = {};\r\n\t\t\t\tvar progress = function(file){\r\n\t\t\t\t\tif (!$progresses[file.id])\r\n\t\t\t\t\t\t$progresses[file.id] = $('<div class=\"media alert alert-warning fade in\"><button type=\"button\" class=\"close\" data-dismiss=\"alert\" aria-label=\"Close\"><span aria-hidden=\"true\">&times;</span></button>' +\r\n\t\t\t\t\t\t\t'<div class=\"media-left media-middle\"><img class=\"media-object\" src=\"\" alt=\"\"></div>' +\r\n\t\t\t\t\t\t\t'<div class=\"media-body\"><h4 class=\"media-heading\">'+file.name.toHTML()+'('+bytesToSize(file.size)+')</h4>' +\r\n\t\t\t\t\t\t\t'<div class=\"media-message\"></div>' +\r\n\t\t\t\t\t\t\t'<div class=\"progress\">' +\r\n\t\t\t\t\t\t\t\t'<div class=\"progress-bar progress-bar-warning progress-bar-striped active\" role=\"progressbar\" aria-valuenow=\"0\" aria-valuemin=\"0\" aria-valuemax=\"100\" style=\"width: 0%\">' +\r\n\t\t\t\t\t\t\t\t\t'<span class=\"\"></span>' +\r\n\t\t\t\t\t\t\t\t'</div>' +\r\n\t\t\t\t\t\t\t'</div>' +\r\n\t\t\t\t\t\t\t'</div>' +\r\n\t\t\t\t\t\t'</div>').appendTo('#'+progresses_id).on('closed.bs.alert', function(){\r\n\t\t\t\t\t\t\tif (file.getStatus() == 'complete')\r\n\t\t\t\t\t\t\t\tprogress(file).remove();\r\n\t\t\t\t\t\t\telse\r\n\t\t\t\t\t\t\t\tprogress(file).cancel();\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\t//console.log(file);\r\n\t\t\t\t\treturn {\r\n\t\t\t\t\t\tinit: function(){\r\n\t\t\t\t\t\t\t$progresses[file.id].removeClass('alert-info alert-danger alert-success alert-warning');\r\n\t\t\t\t\t\t\treturn this;\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tinitProgress: function(){\r\n\t\t\t\t\t\t\t $('.progress-bar', $progresses[file.id]).removeClass('progress-bar-info progress-bar-danger progress-bar-success progress-bar-warning');\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tthumb: function(){\r\n\t\t\t\t\t\t\tflex_uploader.uploader.makeThumb( file, function( error, ret ) {\r\n\t\t\t\t\t\t\t\t$('.media-object', $progresses[file.id]).attr('src', error ? $.baseuri+'placeholder?text='+file.ext+'&size=75x75&fontsize=35' : ret);\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tname: function(name){\r\n\t\t\t\t\t\t\t$('.progressName', $progresses[file.id]).html(name.toHTML());\r\n\t\t\t\t\t\t\treturn this;\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tmessage: function(message){\r\n\t\t\t\t\t\t\t$('.media-message', $progresses[file.id]).html(message);\r\n\t\t\t\t\t\t\treturn this;\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\terror: function(message) {\r\n\t\t\t\t\t\t\tthis.init();\r\n\t\t\t\t\t\t\tthis.initProgress();\r\n\t\t\t\t\t\t\tfile.setStatus('invalid');\r\n\t\t\t\t\t\t\t$progresses[file.id].addClass(\"alert-danger\");\r\n\t\t\t\t\t\t\t$('.progress-bar', $progresses[file.id]).addClass(\"progress-bar-danger\");\r\n\t\t\t\t\t\t\treturn this.message(message);\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tprogressing: function (percentage, is_hashing) {\r\n\t\t\t\t\t\t\tthis.init();\r\n\t\t\t\t\t\t\tthis.initProgress();\r\n\t\t\t\t\t\t\t$progresses[file.id].addClass(\"alert-info\");\r\n\t\t\t\t\t\t\tpercentage = percentage.toFixed(2);\r\n\t\t\t\t\t\t\tvar $bar = $('.progress-bar', $progresses[file.id]).width(percentage + \"%\");\r\n\t\t\t\t\t\t\t$('.progress-bar span', $progresses[file.id]).text(percentage + \"%\");\r\n\t\t\t\t\t\t\tif (percentage < 20)\r\n\t\t\t\t\t\t\t\t$bar.addClass('progress-bar-warning');\r\n\t\t\t\t\t\t\telse if (percentage < 95)\r\n\t\t\t\t\t\t\t\t$bar.addClass('progress-bar-info');\r\n\t\t\t\t\t\t\telse\r\n\t\t\t\t\t\t\t\t$bar.addClass('progress-bar-success');\r\n\t\t\t\t\t\t\tif (percentage < 100) $bar.addClass('active'); else $bar.removeClass('active');\r\n\t\t\t\t\t\t\treturn this.message($.UPLOADER_LANGUAGE.uploading);\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tsuccess: function() {\r\n\t\t\t\t\t\t\tthis.progressing(100);\r\n\t\t\t\t\t\t\tthis.init();\r\n\t\t\t\t\t\t\t$progresses[file.id].addClass(\"alert-success\");\r\n\r\n\t\t\t\t\t\t\t$progresses[file.id].delay(1500).queue(function(){\r\n\t\t\t\t\t\t\t\t$(this).alert('close').dequeue();\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\treturn this.message($.UPLOADER_LANGUAGE.success);\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tcancel: function() {\r\n\t\t\t\t\t\t\tflex_uploader.uploader.cancelFile(file);\r\n\t\t\t\t\t\t\treturn this.remove();\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tremove: function() {\r\n\t\t\t\t\t\t\t$progresses[file.id].remove();\r\n\t\t\t\t\t\t\tdelete $progresses[file.id];\r\n\t\t\t\t\t\t\treturn this;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t};\r\n\t\t\t\t};\r\n\t\t\t\tvar $thumbnails = {};\r\n\t\t\t\tvar preview = function(id, filename, fileext)\r\n\t\t\t\t{\r\n\t\t\t\t\tif (typeof id != 'undefined' && typeof $thumbnails[id] == 'undefined')\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\t$thumbnails[id] = $('<div class=\"col-xs-6 col-md-4 alert\"><div class=\"thumbnail\">' +\r\n\t\t\t\t\t\t\t'<div class=\"file-panel\"><span class=\"cancel\" data-dismiss=\"alert\" aria-label=\"Close\">'+$.UPLOADER_LANGUAGE.close+'</span><span class=\"rotateRight\">'+$.UPLOADER_LANGUAGE.rotate_right+'</span><span class=\"rotateLeft\">'+$.UPLOADER_LANGUAGE.rotate_left+'</span></div>' +\r\n\t\t\t\t\t\t\t'<a href=\"'+$.baseuri+'attachment?id='+id+'\"  target=\"_blank\"><img src=\"'+$.baseuri+'placeholder?size=300x200&text='+encodeURIComponent($.UPLOADER_LANGUAGE.loading)+'\" alt=\"\" class=\"img-responsive center-block\"  onerror=\"this.src=\\''+ $.baseuri +'placeholder?size=300x200&text=\\'+encodeURIComponent(\\''+$.UPLOADER_LANGUAGE.reading+'\\');\"></a>' +\r\n\t\t\t\t\t\t\t'<div class=\"caption\">' +\r\n        \t\t\t\t\t'<h4><span class=\"title\">'+(filename ? filename.toHTML() : '')+'</span><button type=\"button\" class=\"close\" data-dismiss=\"alert\" aria-label=\"Close\"><span aria-hidden=\"true\">&times;</span></button></h4>' +\r\n\t\t\t\t\t\t\t'</div><div class=\"clearfix\"></div>' +\r\n\t\t\t\t\t\t\t'</div><div class=\"clearfix\"></div></div>').appendTo('#' + thumbnails_id).on('closed.bs.alert', function(){\r\n\t\t\t\t\t\t\t\tpreview(id).remove();\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t$('.rotateLeft,.rotateRight', $thumbnails[id]).on('click', function(){\r\n\t\t\t\t\t\t\t\tvar rotation = parseInt($thumbnails[id].data('rotation')) || 0;\r\n\t\t\t\t\t\t\t\trotation += $(this).is('.rotateLeft') ? -90 : 90;\r\n\t\t\t\t\t\t\t\tdeg = 'rotate(' + rotation + 'deg)';\r\n\t\t\t\t\t\t\t\t$('img', $thumbnails[id]).css(\r\n\t\t\t\t\t\t\t\t\t$.supportTransition ? {'-webkit-transform': deg,'-mos-transform': deg,'-o-transform': deg,'transform': deg}\r\n\t\t\t\t\t\t\t\t     : {filter: 'progid:DXImageTransform.Microsoft.BasicImage(rotation='+ (~~((rotation/90)%4 + 4)%4) +')'}\r\n\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t\t$thumbnails[id].data('rotation', rotation);\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\tif (!fileext) \r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t$.GET($.baseuri + 'attachment/info?id='+ id, null, function(json){\r\n\t\t\t\t\t\t\t\tif (typeof json != 'undefined' && (json.result == 'success' || json.result == 'api') && typeof json.data.ext != 'undefined')\r\n\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\tvar pic = img_types.indexOf(json.data.ext.toLowerCase()) > -1 ? $.baseuri + 'attachment/preview?id='+ id : $.baseuri + 'placeholder?size=300x200&text='+encodeURIComponent(json.data.ext);\r\n\t\t\t\t\t\t\t\t\t$('.title', $thumbnails[id]).text(json.data.displayname);\r\n\t\t\t\t\t\t\t\t\t$('img', $thumbnails[id]).attr('src',pic);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tvar pic = img_types.indexOf(fileext.toLowerCase()) > -1 ? $.baseuri + 'attachment/preview?id='+ id: $.baseuri + 'placeholder?size=300x200&text='+ encodeURIComponent(fileext);\r\n\t\t\t\t\t\t\t$('img', $thumbnails[id]).attr('src',pic);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\treturn {\r\n\t\t\t\t\t\tbuild: function(){\r\n\t\t\t\t\t\t\tif (t.triggerHandler('uploader.previewing', [this.getFile(), id, attachment().get()]) === false) return this;\r\n\t\t\t\t\t\t\tattachment().add(id);\r\n\t\t\t\t\t\t\tt.triggerHandler('uploader.previewed',[this.getFile(), id, attachment().get()]);\r\n\t\t\t\t\t\t\treturn this;\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tremove: function(){\r\n\t\t\t\t\t\t\tvar file = this.getFile();\r\n\t\t\t\t\t\t\tif (t.triggerHandler('uploader.removing', [file, id, attachment().get()]) === false) return this;\r\n\t\t\t\t\t\t\tif (file) flex_uploader.uploader.removeFile(file, true);\r\n\t\t\t\t\t\t\tattachment().remove(id);\r\n\t\t\t\t\t\t\t$thumbnails[id].remove();\r\n\t\t\t\t\t\t\tdelete $thumbnails[id];\r\n\t\t\t\t\t\t\tt.triggerHandler('uploader.removed',[file, id, attachment().get()]);\r\n\t\t\t\t\t\t\treturn this;\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tsetFile: function(file){\r\n\t\t\t\t\t\t\t$thumbnails[id].data(\"file\", file);\r\n\t\t\t\t\t\t\treturn this;\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tgetFile: function(){\r\n\t\t\t\t\t\t\treturn $thumbnails[id].data(\"file\");\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tremoveAll: function(){\r\n\t\t\t\t\t\t\tfor (var id in $thumbnails) {\r\n\t\t\t\t\t\t\t\tpreview(id).remove();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\trebuildAll: function() {\r\n\t\t\t\t\t\t\t//remove all files\r\n\t\t\t\t\t\t\tfiles = flex_uploader.uploader.getFiles();\r\n\t\t\t\t\t\t\tfor(var i = 0;i < files.length;i++)\r\n\t\t\t\t\t\t\t\tflex_uploader.uploader.removeFile(files[i], true);\r\n\t\t\t\t\t\t\t//remove all preview\r\n\t\t\t\t\t\t\tthis.removeAll();\r\n\t\t\t\t\t\t\t//build\r\n\t\t\t\t\t\t\tvar aids = attachment().get();\r\n\t\t\t\t\t\t\tfor (i = 0; i < aids.length; i++) {\r\n\t\t\t\t\t\t\t\tpreview(aids[i]).build();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\treturn this;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t};\r\n\t\t\t\t};\r\n\t\t\t\tvar attachment = function() {\r\n\t\t\t\t\tvar aid = t.val();\r\n\t\t\t\t\tif (aid == '0') aid = '';\r\n\t\t\t\t\taids = aid ? ( aid instanceof Array ? aid : aid.split(',') ) : [];\r\n\t\t\t\t\treturn {\r\n\t\t\t\t\t\twrite: function() {\r\n\t\t\t\t\t\t\tif (t.is('select')){\r\n\t\t\t\t\t\t\t\tt.empty();\r\n\t\t\t\t\t\t\t\taids.forEach(function(i){\r\n\t\t\t\t\t\t\t\t\tt.append('<option value=\"'+i+'\">'+i+'</option>');\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tt.val(aids);\r\n\t\t\t\t\t\t\treturn this;\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tadd: function(id) {\r\n\t\t\t\t\t\t\tif (filelimit == 1) aids = [id.toString()];\r\n\t\t\t\t\t\t\tvar i = aids.indexOf(id.toString());\r\n\t\t\t\t\t\t\tif (i == -1) aids.push(id.toString());\r\n\t\t\t\t\t\t\treturn this.write();\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tremove: function(id) {\r\n\t\t\t\t\t\t\tvar i = aids.indexOf(id.toString());\r\n\t\t\t\t\t\t\tif (i != -1) aids.splice(i,1);\r\n\t\t\t\t\t\t\treturn this.write();\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tremoveAll: function(){\r\n\t\t\t\t\t\t\taids = [];\r\n\t\t\t\t\t\t\treturn this.write();\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tget: function(){\r\n\t\t\t\t\t\t\treturn aids;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t};\r\n\t\t\t\t};\r\n\r\n\r\n\t\t\t\t//---------------------------------------\r\n\t\t\t\tmethod.beforeFileQueued = function(file) {\r\n\t\t\t\t\tif (filetype.split(',').indexOf(file.ext.toLowerCase()) == -1){\r\n\t\t\t\t\t\t$.alert($.UPLOADER_LANGUAGE.filetype.replace('{0}', filetype));\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (filelimit > 1 &&  attachment().get().length >= filelimit) {\r\n\t\t\t\t\t\t$.alert($.UPLOADER_LANGUAGE.filenum_limite.replace('{0}', filelimit));\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t};\r\n\t\t\t\tmethod.fileQueued = function(file) {\r\n\t\t\t\t\tif (t.triggerHandler('uploader.uploading', [file, attachment().get()]) === false) return false;\r\n\t\t\t\t\tprogress(file).init().thumb();\r\n\r\n\t\t\t\t\t//前台压缩图片，为避免产生BUG，不检查md5\r\n\t\t\t\t\tif (max_width > 0 && max_height > 0 && (file.ext == 'jpg' || file.ext == 'jpeg'))\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tflex_uploader.uploader.upload(file);\r\n\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tthis.md5File( file ).progress(function(percentage) {\r\n\t\t\t\t\t\tprogress(file).progressing(0).message($.UPLOADER_LANGUAGE.hashing + ' ' + (percentage * 100).toFixed(2) + '%');\r\n\t\t\t\t\t}).then(function(val) {\r\n\t\t\t\t\t\t$.POST($.baseuri + 'attachment/hash_query', {\r\n\t\t\t\t\t\t\thash: val,\r\n\t\t\t\t\t\t\t_token: $.csrf,\r\n\t\t\t\t\t\t\tfilename: file.name,\r\n\t\t\t\t\t\t\text: file.ext,\r\n\t\t\t\t\t\t\tsize: file.size\r\n\t\t\t\t\t\t}, function(json){\r\n\t\t\t\t\t\t\tif (typeof json != 'undefined' && (json.result == 'success' || json.result == 'api')){\r\n\t\t\t\t\t\t\t\tflex_uploader.uploader.skipFile(file);\r\n\t\t\t\t\t\t\t\tprogress(file).success().message($.UPLOADER_LANGUAGE.hash_success);\r\n\t\t\t\t\t\t\t\tif (filelimit == 1) preview().removeAll();\r\n\t\t\t\t\t\t\t\tpreview(json.data.id, json.data.displayname, json.data.ext).build().setFile(file);\r\n\t\t\t\t\t\t\t\tt.triggerHandler('uploader.uploaded',[file, json, attachment().get()]);\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tfile.md5 = val;\r\n\t\t\t\t\t\t\t\tflex_uploader.uploader.upload(file);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t},false);\r\n\t\t\t\t\t});\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t};\r\n\t\t\t\tmethod.uploadBeforeSend = function(obj, data, headers) {\r\n\t\t\t\t\t//console.log(obj);\r\n\t\t\t\t\tdata.uuid = obj.blob.ruid + obj.file.id + obj.file.size;\r\n\t\t\t\t\tdata.start = obj.start;\r\n\t\t\t\t\tdata.end = obj.end;\r\n\t\t\t\t\tdata.chunks = obj.chunks;\r\n\t\t\t\t\tdata.chunk = obj.chunk;\r\n\t\t\t\t\tdata.total = obj.file.size;\r\n\t\t\t\t\tdata.hash = obj.file.md5;\r\n\t\t\t\t};\r\n\t\t\t\tmethod.uploadStart = function(file) {\r\n\t\t\t\t\t\r\n\t\t\t\t};\r\n\t\t\t\t//上传过程中触发，携带上传进度。\r\n\t\t\t\tmethod.uploadProgress = function(file, percentage) {\r\n\t\t\t\t\tt.triggerHandler('uploader.progressing',[file, percentage, attachment().get()]);\r\n\t\t\t\t\tprogress(file).progressing(percentage);\r\n\t\t\t\t};\r\n\t\t\t\t//当文件上传成功时触发。\r\n\t\t\t\tmethod.uploadSuccess = function(file, json) {\r\n\t\t\t\t\tif (json && (json.result == 'success' || json.result == 'api')) {\r\n\t\t\t\t\t\tprogress(file).success();\r\n\t\t\t\t\t\tif (filelimit == 1) preview().removeAll();\r\n\t\t\t\t\t\tpreview(json.data.id, json.data.displayname, json.data.ext).build().setFile(file);\r\n\t\t\t\t\t\tt.triggerHandler('uploader.uploaded',[file, json, attachment().get()]);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tprogress(file).error($.UPLOADER_LANGUAGE.error+': ' + json.message.content);\r\n\t\t\t\t\t\tt.triggerHandler('uploader.error',[file, json.message.content, attachment().get()]);\r\n\t\t\t\t\t\t//$.alert(json.message.content);\r\n\t\t\t\t\t}\r\n\t\t\t\t};\r\n\t\t\t\t\r\n\t\t\t\t//当文件上传出错时触发。\r\n\t\t\t\tmethod.uploadError = function(file, reason) {\r\n\t\t\t\t\tprogress(file).error($.UPLOADER_LANGUAGE.error+': ' + reason);\r\n\t\t\t\t\tt.triggerHandler('uploader.error',[file, reason, attachment().get()]);\r\n\t\t\t\t};\r\n\t\t\t\t//不管成功或者失败，文件上传完成时触发。\r\n\t\t\t\tmethod.uploadComplete = function(file) {\r\n\t\t\t\t\t\r\n\t\t\t\t};\r\n\t\t\t\tmethod.error = function(code, max, file) {\r\n\t\t\t\t\tswitch(code)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tcase 'Q_EXCEED_NUM_LIMIT':\r\n\t\t\t\t\t\t\t$.alert($.UPLOADER_LANGUAGE.num_limit.replace('{0}', max));\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'Q_EXCEED_SIZE_LIMIT':\r\n\t\t\t\t\t\t\t$.alert($.UPLOADER_LANGUAGE.allsize_limit);\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'F_EXCEED_SIZE':\r\n\t\t\t\t\t\t\t$.alert($.UPLOADER_LANGUAGE.filesize_limite.replace('{0}', bytesToSize(filesize)));\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'F_DUPLICATE':\r\n\t\t\t\t\t\t\t$.alert($.UPLOADER_LANGUAGE.duplicate);\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'Q_TYPE_DENIED':\r\n\t\t\t\t\t\t\t$.alert($.UPLOADER_LANGUAGE.filetype.replace('{0}', filetype));\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tdefault:\r\n\t\t\t\t\t\t\t$.alert(code);\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t};\r\n\r\n\t\t\t\tmethod.create = function()\r\n\t\t\t\t{\r\n\t\t\t\t\tif (flex_uploader.uploader || typeof t.prop('flex_uploader') == 'undefined') return;\r\n\t\t\t\t\tflex_uploader.uploader = WebUploader.create({\r\n\t\t\t\t\t\t// swf文件路径\r\n\t\t\t\t\t\tswf: $.baseuri + \"static/js/webuploader/Uploader.swf\",\r\n\t\t\t\t\t\t// 文件接收服务端。\r\n\t\t\t\t\t\tserver: $.baseuri + \"attachment/uploader_query?of=json\",\r\n\t\t\t\t\t\t// 选择文件的按钮。可选。内部根据当前运行是创建，可能是input元素，也可能是flash\r\n\t\t\t\t\t\tpick: {\r\n\t\t\t\t\t\t\tid: '#' + pick_id,\r\n\t\t\t\t\t\t\tmultiple: true\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\t//表单附加数据\r\n\t\t\t\t\t\tformData: $.extend($.session_id ? {\"PHPSESSIONID\": $.session_id} : {}, $.csrf ? {'_token': $.csrf} : {}, {}),\r\n\t\t\t\t\t\t//文件表单name\r\n\t\t\t\t\t\tfileVal: 'Filedata',\r\n\t\t\t\t\t\t//METHOD\r\n\t\t\t\t\t\tmethod: 'POST',\r\n\t\t\t\t\t\t//二进制上传，php://input都为文件内容，其他参数在$_GET中\r\n\t\t\t\t\t\tsendAsBinary: false,\r\n\t\t\t\t\t\t//可提交文件数量限制\r\n\t\t\t\t\t\tfileNumLimit: 0,\r\n\t\t\t\t\t\t//总文件大小限制\r\n\t\t\t\t\t\t//fileSizeLimit: 1024 * 1024 * 1024, //1G\r\n\t\t\t\t\t\t//单文件大小限制\r\n\t\t\t\t\t\tfileSingleSizeLimit: filesize,\r\n\t\t\t\t\t\t//是否去重\r\n\t\t\t\t\t\tduplicate: false,\r\n\t\t\t\t\t\t// 文件选择筛选。\r\n\t\t\t\t\t\taccept: {\r\n\t\t\t\t\t\t\ttitle: $.UPLOADER_LANGUAGE.select_file,\r\n\t\t\t\t\t\t\textensions: filetype,\r\n\t\t\t\t\t\t\tmimeTypes: typeof mimeType != 'undefined' ? filetype.split(',').map(function(v){return mimeType.lookup('name.' + v);}).join(',') : '*/*'\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\t//是否允许在文件传输时提前把下一个文件的分片,MD5准备好\r\n\t\t\t\t\t\tprepareNextFile: true,\r\n\t\t\t\t\t\t//分多大一片？ 默认大小为5M.\r\n\t\t\t\t\t\tchunkSize: 5242880,\r\n\t\t\t\t\t\t//分片允许自动重传多少次\r\n\t\t\t\t\t\tchunkRetry: 5,\r\n\t\t\t\t\t\t//是否分片上传。\r\n\t\t\t\t\t\tchunked: true,\r\n\t\t\t\t\t\t//同时上传并发数\r\n\t\t\t\t\t\tthreads: 3,\r\n\t\t\t\t\t\t//指定拖拽的容器\r\n\t\t\t\t\t\tdnd: '#' + uploader_id,\r\n\t\t\t\t\t\t//全局禁用拉拽，防止默认打开文件\r\n\t\t\t\t\t\tdisableGlobalDnd: true,\r\n\t\t\t\t\t\t//可以粘贴的容器\r\n\t\t\t\t\t\tpaste: document.body,\r\n\t\t\t\t\t\tthumb: {// 缩略图\r\n\t\t\t\t\t\t\twidth: 75,\r\n\t\t\t\t\t\t\theight: 75,\r\n\t\t\t\t\t\t\t// 图片质量，只有type为`image/jpeg`的时候才有效。\r\n\t\t\t\t\t\t\tquality: 70,\r\n\t\t\t\t\t\t\t// 是否允许放大，如果想要生成小图的时候不失真，此选项应该设置为false.\r\n\t\t\t\t\t\t\tallowMagnify: false,\r\n\t\t\t\t\t\t\t// 是否允许裁剪。\r\n\t\t\t\t\t\t\tcrop: true,\r\n\t\t\t\t\t\t\t// 为空的话则保留原有图片格式。\r\n\t\t\t\t\t\t\t// 否则强制转换成指定的类型。\r\n\t\t\t\t\t\t\t//type: 'image/jpeg'\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\t// 不压缩image, 默认如果是jpeg，文件上传前会压缩一把再上传！\r\n\t\t\t\t\t\tresize: false,\r\n\t\t\t\t\t\tcompress: null\r\n\t\t\t\t\t});\r\n\t\t\t\t\t// 修改后图片上传前，尝试将图片压缩到max_width * max_height\r\n\t\t\t\t\tif (max_width > 0 && max_height > 0)\r\n\t\t\t\t\t\tflex_uploader.uploader.option( 'compress', {\r\n\t\t\t\t\t\t\twidth: max_width,\r\n\t\t\t\t\t\t\theight: max_height,\r\n\t\t\t\t\t\t\t// 图片质量，只有type为`image/jpeg`的时候才有效。\r\n\t\t\t\t\t\t\tquality: 100,\r\n\t\t\t\t\t\t\t// 是否允许放大，如果想要生成小图的时候不失真，此选项应该设置为false.\r\n\t\t\t\t\t\t\tallowMagnify: false,\r\n\t\t\t\t\t\t\t// 是否允许裁剪。\r\n\t\t\t\t\t\t\tcrop: false,\r\n\t\t\t\t\t\t\t// 是否保留头部meta信息。\r\n\t\t\t\t\t\t\tpreserveHeaders: true,\r\n\t\t\t\t\t\t\t// 如果发现压缩后文件大小比原来还大，则使用原来图片。此属性可能会影响图片自动纠正功能\r\n\t\t\t\t\t\t\tnoCompressIfLarger: true,\r\n\t\t\t\t\t\t\t// 单位字节，如果图片大小小于此值，不会采用压缩。\r\n\t\t\t\t\t\t\tcompressSize: 0\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\tflex_uploader.uploader.on('beforeFileQueued', method.beforeFileQueued);\r\n\t\t\t\t\tflex_uploader.uploader.on('fileQueued', method.fileQueued);\r\n\t\t\t\t\tflex_uploader.uploader.on('uploadBeforeSend', method.uploadBeforeSend);\r\n\t\t\t\t\tflex_uploader.uploader.on('uploadStart', method.uploadStart);\r\n\t\t\t\t\tflex_uploader.uploader.on('uploadProgress', method.uploadProgress);\r\n\t\t\t\t\tflex_uploader.uploader.on('uploadSuccess', method.uploadSuccess);\r\n\t\t\t\t\tflex_uploader.uploader.on('uploadError', method.uploadError);\r\n\t\t\t\t\tflex_uploader.uploader.on('uploadComplete', method.uploadComplete);\r\n\t\t\t\t\tflex_uploader.uploader.on('error', method.error);\r\n\r\n\t\t\t\t\t//init\r\n\t\t\t\t\tif(id) attachment().add(id);\r\n\t\t\t\t\tpreview().rebuildAll();\r\n\t\t\t\t};\r\n\r\n\t\t\t\tt.prop('flex_uploader', flex_uploader);\r\n\r\n\t\t\t\tif (!flex_uploader.$container.is(':visible')/* flex_uploader.$container[0].offsetParent === null*/) { //默认没有显示出来，需要特殊处理\r\n\t\t\t\t\tmethod.interval = setInterval(function(){\r\n\t\t\t\t\t\tif (flex_uploader.$container.is(':visible'))\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tclearInterval(method.interval);\r\n\t\t\t\t\t\t\tmethod.create();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}, 1000); //还能有更好的方法吗? MutationObserver?\r\n\r\n\t\t\t\t} else {\r\n\t\t\t\t\tmethod.create();\r\n\t\t\t\t}\r\n\r\n\t\t\t});\r\n\t\t\t\r\n\t\t}\r\n\t});\r\n})(jQuery);"]}